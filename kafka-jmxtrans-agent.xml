<jmxtrans-agent>
    <queries>
        <!-- Kafka Server Metrics in Broker -->
        <query objectName="kafka.server:type=BrokerTopicMetrics,name=MessagesInPerSec" attributes="Count,FifteenMinuteRate,FiveMinuteRate,MeanRate,OneMinuteRate" 
            resultAlias="server.BrokerTopicMetrics.MessagesInPerSec.#attribute#"/>

        <query objectName="kafka.server:type=BrokerTopicMetrics,name=BytesInPerSec" attributes="Count,FifteenMinuteRate,FiveMinuteRate,MeanRate,OneMinuteRate"
            resultAlias="server.BrokerTopicMetrics.BytesInPerSec.#attribute#"/>

        <query objectName="kafka.server:type=BrokerTopicMetrics,name=ReplicationBytesInPerSec" attributes="Count,FifteenMinuteRate,FiveMinuteRate,MeanRate,OneMinuteRate"
            resultAlias="server.BrokerTopicMetrics.ReplicationBytesInPerSec.#attribute#"/>

        <query objectName="kafka.server:type=BrokerTopicMetrics,name=BytesOutPerSec" attributes="Count,FifteenMinuteRate,FiveMinuteRate,MeanRate,OneMinuteRate"
            resultAlias="server.BrokerTopicMetrics.BytesOutPerSec.#attribute#"/>
        
        <query objectName="kafka.server:type=BrokerTopicMetrics,name=ReplicationBytesOutPerSec" attributes="Count,FifteenMinuteRate,FiveMinuteRate,MeanRate,OneMinuteRate"
            resultAlias="server.BrokerTopicMetrics.ReplicationBytesOutPerSec.#attribute#"/>
        
        <query objectName="kafka.server:type=BrokerTopicMetrics,name=NoKeyCompactedTopicRecordsPerSec" attributes="Count,FifteenMinuteRate,FiveMinuteRate,MeanRate,OneMinuteRate"
            resultAlias="server.BrokerTopicMetrics.NoKeyCompactedTopicRecordsPerSec.#attribute#"/>
        
        <query objectName="kafka.server:type=BrokerTopicMetrics,name=InvalidMagicNumberRecordsPerSec" attributes="Count,FifteenMinuteRate,FiveMinuteRate,MeanRate,OneMinuteRate"
            resultAlias="server.BrokerTopicMetrics.InvalidMagicNumberRecordsPerSec.#attribute#"/>
        
        <query objectName="kafka.server:type=BrokerTopicMetrics,name=InvalidMessageCrcRecordsPerSec" attributes="Count,FifteenMinuteRate,FiveMinuteRate,MeanRate,OneMinuteRate"
            resultAlias="server.BrokerTopicMetrics.InvalidMessageCrcRecordsPerSec.#attribute#"/>
        
        <query objectName="kafka.server:type=BrokerTopicMetrics,name=ReassignmentBytesOutPerSec" attributes="Count,FifteenMinuteRate,FiveMinuteRate,MeanRate,OneMinuteRate"
            resultAlias="server.BrokerTopicMetrics.ReassignmentBytesOutPerSec.#attribute#"/>
        
        <query objectName="kafka.server:type=BrokerTopicMetrics,name=ReassignmentBytesInPerSec" attributes="Count,FifteenMinuteRate,FiveMinuteRate,MeanRate,OneMinuteRate"
            resultAlias="server.BrokerTopicMetrics.ReassignmentBytesInPerSec.#attribute#"/>
        
        <query objectName="kafka.server:type=BrokerTopicMetrics,name=TotalProduceRequestsPerSec" attributes="Count,FifteenMinuteRate,FiveMinuteRate,MeanRate,OneMinuteRate"
            resultAlias="server.BrokerTopicMetrics.TotalProduceRequestsPerSec.#attribute#"/>
        
        <query objectName="kafka.server:type=BrokerTopicMetrics,name=TotalFetchRequestsPerSec" attributes="Count,FifteenMinuteRate,FiveMinuteRate,MeanRate,OneMinuteRate"
            resultAlias="server.BrokerTopicMetrics.TotalFetchRequestsPerSec.#attribute#"/>
        
        <query objectName="kafka.server:type=BrokerTopicMetrics,name=FailedProduceRequestsPerSec" attributes="Count,FifteenMinuteRate,FiveMinuteRate,MeanRate,OneMinuteRate"
            resultAlias="server.BrokerTopicMetrics.FailedProduceRequestsPerSec.#attribute#"/>
        
        <query objectName="kafka.server:type=BrokerTopicMetrics,name=FailedFetchRequestsPerSec" attributes="Count,FifteenMinuteRate,FiveMinuteRate,MeanRate,OneMinuteRate"
            resultAlias="server.BrokerTopicMetrics.FailedFetchRequestsPerSec.#attribute#"/>
        
        <query objectName="kafka.server:type=BrokerTopicMetrics,name=InvalidOffsetOrSequenceRecordsPerSec" attributes="Count,FifteenMinuteRate,FiveMinuteRate,MeanRate,OneMinuteRate"
            resultAlias="server.BrokerTopicMetrics.InvalidOffsetOrSequenceRecordsPerSec.#attribute#"/>
        
        <query objectName="kafka.server:type=BrokerTopicMetrics,name=BytesRejectedPerSec" attributes="Count,FifteenMinuteRate,FiveMinuteRate,MeanRate,OneMinuteRate"
            resultAlias="server.BrokerTopicMetrics.BytesRejectedPerSec.#attribute#"/>
        
        <query objectName="kafka.server:type=BrokerTopicMetrics,topic=*" attributes="Count,FifteenMinuteRate,FiveMinuteRate,MeanRate,OneMinuteRate"
            resultAlias="server.BrokerTopicMetrics.topic.%topic%.%name%.#attribute#"/>
        
        <query objectName="kafka.server:type=ReplicaManager,name=AtMinIsrPartitionCount" 
            resultAlias="server.ReplicaManager.AtMinIsrPartitionCount.#attribute#"/>
        
        <query objectName="kafka.server:type=ReplicaManager,name=FailedIsrUpdatesPerSec" attributes="Count,FifteenMinuteRate,FiveMinuteRate,MeanRate,OneMinuteRate" 
            resultAlias="server.ReplicaManager.FailedIsrUpdatesPerSec.#attribute#"/>
        
        <query objectName="kafka.server:type=ReplicaManager,name=IsrExpandsPerSec" attributes="Count,FifteenMinuteRate,FiveMinuteRate,MeanRate,OneMinuteRate"
            resultAlias="server.ReplicaManager.IsrExpandsPerSec.#attribute#"/>
        
        <query objectName="kafka.server:type=ReplicaManager,name=IsrShrinksPerSec" attributes="Count,FifteenMinuteRate,FiveMinuteRate,MeanRate,OneMinuteRate"
            resultAlias="server.ReplicaManager.IsrShrinksPerSec.#attribute#"/>
        
        <query objectName="kafka.server:type=ReplicaManager,name=LeaderCount"
            resultAlias="server.ReplicaManager.LeaderCount.#attribute#"/>
        
        <query objectName="kafka.server:type=ReplicaManager,name=OfflineReplicaCount" 
            resultAlias="server.ReplicaManager.OfflineReplicaCount.#attribute#"/>
        
        <query objectName="kafka.server:type=ReplicaManager,name=PartitionCount" 
            resultAlias="server.ReplicaManager.PartitionCount.#attribute#"/>
        
        <query objectName="kafka.server:type=ReplicaManager,name=ReassigningPartitions"
            resultAlias="server.ReplicaManager.ReassigningPartitions.#attribute#"/>
        
        <query objectName="kafka.server:type=ReplicaManager,name=UnderMinIsrPartitionCount"
            resultAlias="server.ReplicaManager.UnderMinIsrPartitionCount.#attribute#"/>
        
        <query objectName="kafka.server:type=ReplicaManager,name=UnderReplicatedPartitions"
            resultAlias="server.ReplicaManager.UnderReplicatedPartitions.#attribute#"/>
        
        <query objectName="kafka.server:type=ReplicaFetcherManager,*" 
            resultAlias="server.ReplicaFetcherManager.clientId.Replica.%name%.#attribute#"/>
        
        <query objectName="kafka.server:type=DelayedOperationPurgatory,*"
            resultAlias="server.DelayedOperationPurgatory.delayedOperation.%delayedOperation%.%name%.#attribute#"/>
        
        <query objectName="kafka.server:type=DelayedFetchMetrics,*" attributes="Count,FifteenMinuteRate,FiveMinuteRate,MeanRate,OneMinuteRate"
            resultAlias="server.DelayedFetchMetrics.fetcherType.%fetcherType%.%name%.#attribute#"/>
        
        <query objectName="kafka.server:type=DelayedProduceMetrics,name=ExpiresPerSec,*" attributes="Count,FifteenMinuteRate,FiveMinuteRate,MeanRate,OneMinuteRate"
            resultAlias="server.DelayedProduceMetrics.partition.%partition%.topic.%topic%.ExpiresPerSec.#attribute#"/>
        
        <query objectName="kafka.server:type=DelayedProduceMetrics,name=ExpiresPerSec" attributes="Count,FifteenMinuteRate,FiveMinuteRate,MeanRate,OneMinuteRate"
            resultAlias="server.DelayedProduceMetrics.ExpiresPerSec.#attribute#"/>
        
        <query objectName="kafka.server:type=FetchSessionCache,*" attributes="Count,FifteenMinuteRate,FiveMinuteRate,MeanRate,OneMinuteRate"
            resultAlias="server.FetchSessionCache.%name%.#attribute#"/>
        
        <query objectName="kafka.server:type=FetcherLagMetrics,*"
            resultAlias="server.FetcherLagMetrics.clientId.%clientId%.partition.%partition%.topic.%topic%.%name%.#attribute#"/>
        
        <query objectName="kafka.server:type=FetcherStats,*" attributes="Count,FifteenMinuteRate,FiveMinuteRate,MeanRate,OneMinuteRate"
            resultAlias="server.FetcherStats.brokerHost.%brokerHost%.brokerPort.%brokerPort%.clientId.%clientId%.%name%.#attribute#"/>
        
        <query objectName="kafka.server:type=KafkaRequestHandlerPool,name=RequestHandlerAvgIdlePercent" attributes="Count,FifteenMinuteRate,FiveMinuteRate,MeanRate,OneMinuteRate" 
            resultAlias="server.KafkaRequestHandlerPool.RequestHandlerAvgIdlePercent.#attribute#"/>
        
        <query objectName="kafka.server:type=KafkaServer,*"
            resultAlias="server.KafkaServer.%name%.#attribute#"/>
        
        <query objectName="kafka.server:type=ReplicaAlterLogDirsManager,*" 
            resultAlias="server.ReplicaAlterLogDirsManager.clientId.ReplicaAlterLogDirs.%name%.#attribute#"/>
        
        <query objectName="kafka.server:type=SessionExpireListener,name=ZooKeeperAuthFailuresPerSec" attributes="Count,FifteenMinuteRate,FiveMinuteRate,MeanRate,OneMinuteRate"
            resultAlias="server.SessionExpireListener.ZooKeeperAuthFailuresPerSec.#attribute#"/>
        
        <query objectName="kafka.server:type=SessionExpireListener,name=ZooKeeperDisconnectsPerSec" attributes="Count,FifteenMinuteRate,FiveMinuteRate,MeanRate,OneMinuteRate"
            resultAlias="server.SessionExpireListener.ZooKeeperDisconnectsPerSec.#attribute#"/>
        
        <query objectName="kafka.server:type=SessionExpireListener,name=ZooKeeperExpiresPerSec" attributes="Count,FifteenMinuteRate,FiveMinuteRate,MeanRate,OneMinuteRate"
            resultAlias="server.SessionExpireListener.ZooKeeperExpiresPerSec.#attribute#"/>
        
        <query objectName="kafka.server:type=SessionExpireListener,name=ZooKeeperReadOnlyConnectsPerSec" attributes="Count,FifteenMinuteRate,FiveMinuteRate,MeanRate,OneMinuteRate"
            resultAlias="server.SessionExpireListener.ZooKeeperReadOnlyConnectsPerSec.#attribute#"/>
        
        <query objectName="kafka.server:type=SessionExpireListener,name=ZooKeeperSaslAuthenticationsPerSec" attributes="Count,FifteenMinuteRate,FiveMinuteRate,MeanRate,OneMinuteRate"
            resultAlias="server.SessionExpireListener.ZooKeeperSaslAuthenticationsPerSec.#attribute#"/>
        
        <query objectName="kafka.server:type=SessionExpireListener,name=ZooKeeperSyncConnectsPerSec" attributes="Count,FifteenMinuteRate,FiveMinuteRate,MeanRate,OneMinuteRate"
            resultAlias="server.SessionExpireListener.ZooKeeperSyncConnectsPerSec.#attribute#"/>
        
        <query objectName="kafka.server:type=ZooKeeperClientMetrics,*"
            resultAlias="server.ZooKeeperClientMetrics.%name%.#attribute#"/>
        
        <query objectName="kafka.server:type=LeaderReplication" 
            resultAlias="server.LeaderReplication.#attribute#"/>
        
        <!-- Kafka Controller Metrics in Broker -->
        <query objectName="kafka.controller:type=ControllerChannelManager,name=QueueSize,broker-id=*"
            resultAlias="controller.ControllerChannelManager.broker-id.%broker-id%.QueueSize.#attribute#"/>
        
        <query objectName="kafka.controller:type=ControllerChannelManager,name=RequestRateAndQueueTimeMs,broker-id=*" 
            resultAlias="controller.ControllerChannelManager.broker-id.%broker-id%.RequestRateAndQueueTimeMs.#attribute#"/>
        
        <query objectName="kafka.controller:type=ControllerChannelManager,name=TotalQueueSize"
            resultAlias="controller.ControllerChannelManager.TotalQueueSize.#attribute#"/>
        
        <query objectName="kafka.controller:type=ControllerEventlManager,*" 
            resultAlias="controller.ControllerEventlManager.%name%.#attribute#"/>
        
        <query objectName="kafka.controller:type=KafkaController,*"
            resultAlias="controller.KafkaController.%name%.#attribute#"/>
        
        <query objectName="kafka.controller:type=ControllerStats,*" attributes="50thPercentile,75thPercentile,95thPercentile,98thPercentile,999thPercentile,99thPercentile,Count,FifteenMinuteRate,FiveMinuteRate,Max,Mean,MeanRate,Min,OneMinuteRate,StdDev" 
            resultAlias="controller.ControllerStats.%name%.#attribute#"/>

        <!-- Kafka Coordinator Metrics in Broker -->
        <query objectName="kafka.coordinator.group:type=GroupMetadataManager,*"
            resultAlias="coordinator.group.GroupMetadataManager.%name%.#attribute#"/>

        <query objectName="kafka.coordinator.transaction:type=TransactionMarkerChannelManager,*"
            resultAlias="coordinator.transaction.TransactionMarkerChannelManager.%name%.#attribute#"/>

        <!-- Kafka Network Metrics in Broker -->
        <query objectName="kafka.network:type=Acceptor,name=AcceptorBlockedPercent,listener=PLAINTEXT" attributes="Count,FifteenMinuteRate,FiveMinuteRate,MeanRate,OneMinuteRate"
            resultAlias="network.Acceptor.listener.PLAINTEXT.AcceptorBlockedPercent.#attribute#"/>
        
        <query objectName="kafka.network:type=Processor,*"
            resultAlias="network.Processor.networkProcessor.%networkProcessor%.%name%.#attribute#"/>
        
        <query objectName="kafka.network:type=RequestChannel,name=RequestQueueSize"
            resultAlias="network.RequestChannel.RequestQueueSize.#attribute#"/>

        <query objectName="kafka.network:type=RequestChannel,name=ResponseQueueSize"
            resultAlias="network.RequestChannel.ResponseQueueSize.#attribute#"/>

        <query objectName="kafka.network:type=RequestChannel,name=ResponseQueueSize,processor=*"
            resultAlias="network.RequestChannel.processor.%processor%.ResponseQueueSize.#attribute#"/>

        <query objectName="kafka.network:type=RequestMetrics,name=LocalTimeMs,request=*"
            resultAlias="network.RequestMetrics.request.%request%.LocalTimeMs.#attribute#"/>

        <query objectName="kafka.network:type=RequestMetrics,name=RemoteTimeMs,request=*"
            resultAlias="network.RequestMetrics.request.%request%.RemoteTimeMs.#attribute#"/>

        <query objectName="kafka.network:type=RequestMetrics,name=RequestQueueTimeMs,request=*"
            resultAlias="network.RequestMetrics.request.%request%.RequestQueueTimeMs.#attribute#"/>

        <query objectName="kafka.network:type=RequestMetrics,name=RequestsPerSec,request=*" attributes="Count,FifteenMinuteRate,FiveMinuteRate,MeanRate,OneMinuteRate"
            resultAlias="network.RequestMetrics.request.%request%.RequestsPerSec.#attribute#"/>

        <query objectName="kafka.network:type=RequestMetrics,name=ResponseSendTimeMs,request=*"
            resultAlias="network.RequestMetrics.request.%request%.ResponseSendTimeMs.#attribute#"/>

        <query objectName="kafka.network:type=RequestMetrics,name=ResponseQueueTimeMs,request=*"
            resultAlias="network.RequestMetrics.request.%request%.ResponseQueueTimeMs.#attribute#"/>

        <query objectName="kafka.network:type=RequestMetrics,name=ThrottleTimeMs,request=*"
            resultAlias="network.RequestMetrics.request.%request%.ThrottleTimeMs.#attribute#"/>

        <query objectName="kafka.network:type=RequestMetrics,name=TotalTimeMs,request=*"
            resultAlias="network.RequestMetrics.request.%request%.TotalTimeMs.#attribute#"/>

        <query objectName="kafka.network:type=RequestMetrics,name=RequestBytes,request=*"
            resultAlias="network.RequestMetrics.request.%request%.RequestBytes.#attribute#"/>

        <query objectName="kafka.network:type=RequestMetrics,name=MessageConversionsTimeMs,request=*"
            resultAlias="network.RequestMetrics.request.%request%.MessageConversionsTimeMs.#attribute#"/>

        <query objectName="kafka.network:type=RequestMetrics,name=TemporaryMemoryBytes,request=*"
            resultAlias="network.RequestMetrics.request.%request%.TemporaryMemoryBytes.#attribute#"/>

        <query objectName="kafka.network:type=RequestMetrics,name=ErrorsPerSec,*" attributes="Count,FifteenMinuteRate,FiveMinuteRate,MeanRate,OneMinuteRate"
            resultAlias="network.RequestMetrics.error.%error%.request.%request%.ErrorsPerSec.#attribute#"/>

        <query objectName="kafka.network:type=SocketServer,*"
            resultAlias="network.SocketServer.%name%.#attribute#"/>

        <!-- Kafka Log Metrics in Broker -->
        <query objectName="kafka.log:type=Log,*"
            resultAlias="log.Log.partition.%partition%.topic.%topic%.%name%.#attribute#"/>

        <query objectName="kafka.log:type=LogCleaner,*"
            resultAlias="log.LogCleaner.%name%.#attribute#"/>

        <query objectName="kafka.log:name=LogFlushRateAndTimeMs,type=LogFlushStats" attributes="50thPercentile,75thPercentile,95thPercentile,98thPercentile,999thPercentile,99thPercentile,Count,FifteenMinuteRate,FiveMinuteRate,Max,Mean,MeanRate,Min,OneMinuteRate,StdDev"
            resultAlias="log.LogFlushStats.LogFlushRateAndTimeMs.#attribute#"/>

        <query objectName="kafka.log:type=LogManager,name=OfflineLogDirectoryCount"
            resultAlias="log.LogManager.OfflineLogDirectoryCount.#attribute#"/>

        <query objectName="kafka.log:type=LogManager,name=LogDirectoryOffline,*"
            resultAlias="log.LogManager.logDirectory.%logDirectory%.LogDirectoryOffline.#attribute#"/>

        <query objectName="kafka.log:type=LogCleanerManager,name=time-since-last-run-ms"
            resultAlias="log.LogCleanerManager.time-since-last-run-ms.#attribute#"/>

        <query objectName="kafka.log:type=LogCleanerManager,name=uncleanable-bytes,*"
            resultAlias="log.LogCleanerManager.logDirectory.%logDirectory%.uncleanable-bytes.#attribute#"/>

        <query objectName="kafka.log:type=LogCleanerManager,name=uncleanable-partitions-count,*"
            resultAlias="log.LogCleanerManager.logDirectory.%logDirectory%.uncleanable-partitions-count.#attribute#"/>

        <!-- Kafka Utils Metrics in Broker -->
        <query objectName="kafka.utils:type=Throttler,name=cleaner-io" attributes="Count,FifteenMinuteRate,FiveMinuteRate,MeanRate,OneMinuteRate"
            resultAlias="utils.Throttler.cleaner-io.#attribute#"/>

        <!-- Kafka Cluster Metrics in Broker -->
        <query objectName="kafka.cluster:type=Partition,*"
            resultAlias="cluster.Partition.partition.%partition%.topic.%topic%.%name%.#attribute#"/>
    </queries>

    <outputWriter class="org.jmxtrans.agent.RollingFileOutputWriter">
        <fileName>/tmp/kafka.txt</fileName>
        <maxFileSize>10</maxFileSize>
        <maxBackupIndex>4</maxBackupIndex>
    </outputWriter>
    <outputWriter class="org.jmxtrans.agent.GraphitePlainTextTcpOutputWriter">
        <host>d974d971.carbon.hostedgraphite.com</host>
        <port>2003</port>
        <namePrefix>abb76b49-af6e-4db2-aa2c-458dae48e6fa.cmMonitor.kafka-test-jmxtrans.kafka.</namePrefix>
    </outputWriter>
    <collectIntervalInSeconds>60</collectIntervalInSeconds>
</jmxtrans-agent>